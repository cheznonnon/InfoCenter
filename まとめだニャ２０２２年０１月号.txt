<pre style="font-family:Meiryo;">
</pre>

----------==========----------==========----------==========----------

■まとめだニャ２０２２年０１月号

[ ０１月１０日 ]

◇ニューフィーチャー

■win32/win_simplemenu.c

ドロップシャドウを自分で描画するニャ
ただしある種のトレードオフがあるのニャ

■neutral/bmp/ui/rectframe.c
■neutral/bmp/ui/roundframe.c

リリースだニャ
リンクエラーが出るのでこちらに移動したニャ

今の所は暫定的立ち位置だニャ
自動的にはインクルードされないニャ

■win32/win_combobox.c

旧来の四角形のモードとシステムのラウンドとオリジナルのラウンドが選べるようになったニャ

Win32 AnimateWindow() をエミュレートするようになったニャ

■win32/win/fluent_ui.c

n_win_fluent_ui_bmp_roundframe_main() を廃止したニャ
半透明時に描画エラーが出るためだニャ
シンプルな場合は新しく作った n_bmp_ui_roundframe() が使えるニャ

■OrangeCat

マウスの X ボタンと呼ばれるものをサポートしたニャ
最近 Classic IntelliMouse を買ったらボタンが２つ付いてきたためだニャ
ただし「進む」というインフラはないから「戻る」だけだニャ

■neutral/bmp/detect.c

n_bmp_roundrect_detect_coeff() に不完全なコードがあったのを修正したニャ

■win32/win_scrollbar.c

親ウィンドウの n_bmp のバッファに書き込むモードが実装されたニャ

■project/cardgenerator/cardgenerator.c

ダークモードの時のコーナーがもっと綺麗になったニャ

■Wheel Axl

メインアイコンを新しくしたニャ


◇バグフィクス

■win32/win/fluent_ui.c

n_win_fluent_ui_label() でテキストが大きい時にクリッピングしないのを直したニャ

n_gdi_frame_rectframe() のリンクエラーが出るのを直したニャ

n_win_fluent_ui_bmp_desktop() が Win2000 以前で機能しないのを直したニャ
アルファ値がゼロになっているという問題だニャ

■win32/win_simplemenu.c

ヘッダをクリックした時にフリッカするのを直したニャ

■win32/win_inputpopup.c

Win2000 より古いバージョンで、
数字だけのモードでアルファベットボタンがグレーアウトしないのを直したニャ

高 DPI で Flent UI の時にボタンのコーナーが見えてしまうのを直したニャ
直したというかパディングを入れて上手くごまかしたニャ
これはマイクロソフトが Windows 11 でも使っている手法だニャ

■Nonnon Paint

Win2000 より古いバージョンで起動時にペンボタンがフェードするのを直したニャ

リサイザーでサイズを変更した時にプレビューが反映されないことがあるのを直したニャ

■CatPad

タブの増減をしたときに上書きボタンが有効にならないのを直したニャ

■win32/win/txtbox/07_metrics.c

n_win_txtbox_metrics_canvas() のキャンバスサイズの計算が間違っているのを直したニャ
高 DPI で顕著に狂いが出るニャ

■Watchcat

リサイズすると再描画に失敗することがあるのを直したニャ

選択状態で更新がかかった時に
１：描画エラーが出る
２：メモリリークが起こる
のを直したニャ

■TxtBox : スモールボタン

高 DPI の時に右側に上書きされてしまう問題を直したニャ

■neutral/bmp/detect.c

n_bmp_roundrect_detect_coeff() の実装に誤りがあるのを直したニャ
n_bmp_ellipse_detect_coeff() も coeff の計算に誤りがあったニャ

■Toolband

Fluent UI のコーナーの描画が速くなったニャ
なんかワンテンポ遅れる感じがなくなったニャ


[ ０１月２０日 ]

◇ニューフィーチャー

■CatPad/TxtBox

もっと軽くなったニャ

■コンボボックス

Fluent UI でない時に矢印アイコンをシステムに近いものに変えたニャ

■Felis

マウスの X ボタンをサポートしたニャ
進むと戻るが有効になるニャ

■Marie / Nonnon Paint / OrangeCat

WIC Windows Imaging Component をサポートしたニャ
TIFF とか特殊なファイルが開けるようになるニャ
ただし開くだけで保存はできないニャ
Webp は Win10 なら開くことができるニャ

■TxtBox

n_win_txtbox_scaling() を scale_set() にリネームしたニャ
.scale_double もセットするニャ

n_win_txtbox_metrics() がごちゃごちゃしているのを整理したニャ

■hunyapiyo3

配色がテーマを適用するようになったニャ
問題が起こるのでハイコントラストの時だけ元のままにとどめるニャ


◇バグフィクス

■猫の手

検索でドットを付けたり外したりする時に再描画されないのを直したニャ

■Nonnon Paint

ミラーのアイコンがテーマが適応されないのでベタ塗りにしたニャ
元のはグラデーションがかかっていたニャ

■TxtBox

Win9x で入力フィールドの時に上側が描画されないのを直したニャ

リサイズ時にウィンドウサイズが小さくなるとスクロールバーの描画が乱れるのを直したニャ


[ ０１月３０日 ]

◇ニューフィーチャー

■win32/win_txtbox.c

misc.c と draw.c を更に分割したニャ
draw.c は３０００行もあって管理限界を超えていたニャ

フォルダ内のファイル名を変えたニャ

■game/progressbar.c

ロジックを再編したニャ

■win32/gdi.c

(u32) .frame_corner_color が新設されたニャ
ラウンドレクトの時にコーナーの色を指定できるニャ

■neutral/memory.c

n_memory_copy() を安全じゃないけど高速なモードに変えたニャ
ベンチマークを取ったら memove() より memcpy() の方が速いことが判明したためだニャ

■64-bit 版

Visual C++ の警告を握りつぶしている部分を減らしたニャ

最後適用できるのが１つ残ったのニャがまだ途中までしか対応していないので残されているニャ

■neutral/type.c

n_type_gfx と n_type_int を作ったニャ
最初は int 次に size_t そして s32 u32 s64 u64 の併用を経て最後に行きついた答えだニャ

ビットマップの座標は s32 に変わる n_type_gfx を使うニャ
メモリの添え字他カウンタに使う場合は s64 に変わる n_type_int を使うニャ
ファイルフォーマットを扱うときはいつも通り全部の型を使うニャ

後で整数オーバーフロー防止にも応用する予定だニャ


◇バグフィクス

■INI2GDI

ラウンドのコーナーが常にゼロで描画されるの直したニャ
新しいパラメータ "frame_corner_color" で制御できるニャ

■TxtBox

選択されている時に左矢印キーを押すと間違った動きをするのを直したニャ

ラウンドレクトの時にボーダーが .border_pxl_sx/sy を反映しないのを直したニャ

検索して選択領域を消すとキャレットが変な位置にワープするのを直したニャ

右方向にキャレットを移動する時に点滅するのを直したニャ

■win32/win_simplemenu.c

Fluent UI の時にぼかしから黒が除外されるのを直したニャ
クロマキー機能がオンになっているという問題だニャ

■N_MEMORY_DEBUG

コンパイルエラーになるのを直したニャ

■メモリ解放漏れを直したニャ

長年の開発で問題が沢山発見されたニャ
でもほとんどが１回だけ初期化されるものの終了時の解放漏れだったニャ
動的にリークが増えていくということはないニャ

hunyapiyo3
Card Generator
Nonnon Freecell
Nonnon Spider

CatPad
Felis
n_attrib
nmidi
Nyaurism
Pen Trainer
Project Checker

■OrangeCat

フォーカスキーパーが機能しないのを直したニャ
いつぞやにドラッグ選択を優先したため起こるようになったニャ

■Felis

アクセスリストのフォントがテーマのものでないのを直したニャ

■VC++ : 暗黙のキャスト

#pragma でサプレスしているものを減らしたニャ
ArcDrop と GameConsole に属するものを対応させたニャ

----------==========----------==========----------==========----------

